import{y as j,z as Le,A as se,B as Ce,o as we,p as ce,C as ye,j as re,D as Te,F as xe,G as he,u as be,H as ze,E as V,I as Se,J as Ne,K as Oe,L as Re,N as $e,O as Ae,P as Be,_ as ke,Q as K,R as H,T as Me,w as Ie,U as Ve,V as De,h as Fe}from"./base-2d98388c.js";import{l as ie,N as ve,k as z,O as Pe,P as We,g as _,h as de,n as _e,Q as Ee,o as T,d as fe,b as y,w as S,a as C,q as b,u as a,D as me,x as Xe,C as N,c as M,F as oe,e as Ye,R as He,s as je,S as Ke,z as ae,T as Ue,U as Ze,V as qe,W as Ge,B as Qe}from"./index-87a0bc49.js";import{u as Je}from"./index-0743fc75.js";import{g as et}from"./scroll-ea313282.js";const tt=(e,o)=>{if(!j||!e||!o)return!1;const s=e.getBoundingClientRect();let r;return o instanceof Element?r=o.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<r.bottom&&s.bottom>r.top&&s.right>r.left&&s.left<r.right};var nt=/\s/;function at(e){for(var o=e.length;o--&&nt.test(e.charAt(o)););return o}var st=/^\s+/;function rt(e){return e&&e.slice(0,at(e)+1).replace(st,"")}var pe=0/0,ot=/^[-+]0x[0-9a-f]+$/i,it=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,ut=parseInt;function ge(e){if(typeof e=="number")return e;if(Le(e))return pe;if(se(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=se(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=rt(e);var s=it.test(e);return s||lt.test(e)?ut(e.slice(2),s?2:8):ot.test(e)?pe:+e}var ct=function(){return Ce.Date.now()};const le=ct;var dt="Expected a function",ft=Math.max,mt=Math.min;function vt(e,o,s){var r,f,k,l,p,h,I=0,E=!1,g=!1,m=!0;if(typeof e!="function")throw new TypeError(dt);o=ge(o)||0,se(s)&&(E=!!s.leading,g="maxWait"in s,k=g?ft(ge(s.maxWait)||0,o):k,m="trailing"in s?!!s.trailing:m);function v(u){var w=r,$=f;return r=f=void 0,I=u,l=e.apply($,w),l}function c(u){return I=u,p=setTimeout(R,o),E?v(u):l}function D(u){var w=u-h,$=u-I,X=o-w;return g?mt(X,k-$):X}function O(u){var w=u-h,$=u-I;return h===void 0||w>=o||w<0||g&&$>=k}function R(){var u=le();if(O(u))return W(u);p=setTimeout(R,D(u))}function W(u){return p=void 0,m&&r?v(u):(r=f=void 0,l)}function U(){p!==void 0&&clearTimeout(p),I=0,r=h=f=p=void 0}function F(){return p===void 0?l:W(le())}function P(){var u=le(),w=O(u);if(r=arguments,f=this,h=u,w){if(p===void 0)return c(h);if(g)return clearTimeout(p),p=setTimeout(R,o),v(h)}return p===void 0&&(p=setTimeout(R,o)),l}return P.cancel=U,P.flush=F,P}var pt="Expected a function";function ue(e,o,s){var r=!0,f=!0;if(typeof e!="function")throw new TypeError(pt);return se(s)&&(r="leading"in s?!!s.leading:r,f="trailing"in s?!!s.trailing:f),vt(e,o,{leading:r,maxWait:o,trailing:f})}const gt=we({urlList:{type:ce(Array),default:()=>ye([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),wt={close:()=>!0,switch:e=>re(e),rotate:e=>re(e)},yt=["src"],ht=ie({name:"ElImageViewer"}),bt=ie({...ht,props:gt,emits:wt,setup(e,{expose:o,emit:s}){const r=e,f={CONTAIN:{name:"contain",icon:ve(Te)},ORIGINAL:{name:"original",icon:ve(xe)}},{t:k}=he(),l=be("image-viewer"),{nextZIndex:p}=ze(),h=z(),I=z([]),E=Pe(),g=z(!0),m=z(r.initialIndex),v=We(f.CONTAIN),c=z({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=_(()=>{const{urlList:t}=r;return t.length<=1}),O=_(()=>m.value===0),R=_(()=>m.value===r.urlList.length-1),W=_(()=>r.urlList[m.value]),U=_(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!r.infinite&&O.value)]),F=_(()=>[l.e("btn"),l.e("next"),l.is("disabled",!r.infinite&&R.value)]),P=_(()=>{const{scale:t,deg:i,offsetX:d,offsetY:L,enableTransition:A}=c.value;let x=d/t,B=L/t;switch(i%360){case 90:case-270:[x,B]=[B,-x];break;case 180:case-180:[x,B]=[-x,-B];break;case 270:case-90:[x,B]=[-B,x];break}const Y={transform:`scale(${t}) rotate(${i}deg) translate(${x}px, ${B}px)`,transition:A?"transform .3s":""};return v.value.name===f.CONTAIN.name&&(Y.maxWidth=Y.maxHeight="100%"),Y}),u=_(()=>re(r.zIndex)?r.zIndex:p());function w(){X(),s("close")}function $(){const t=ue(d=>{switch(d.code){case H.esc:r.closeOnPressEscape&&w();break;case H.space:ee();break;case H.left:te();break;case H.up:n("zoomIn");break;case H.right:ne();break;case H.down:n("zoomOut");break}}),i=ue(d=>{const L=d.deltaY||d.deltaX;n(L<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});E.run(()=>{K(document,"keydown",t),K(document,"wheel",i)})}function X(){E.stop()}function G(){g.value=!1}function Q(t){g.value=!1,t.target.alt=k("el.image.error")}function J(t){if(g.value||t.button!==0||!h.value)return;c.value.enableTransition=!1;const{offsetX:i,offsetY:d}=c.value,L=t.pageX,A=t.pageY,x=ue(Y=>{c.value={...c.value,offsetX:i+Y.pageX-L,offsetY:d+Y.pageY-A}}),B=K(document,"mousemove",x);K(document,"mouseup",()=>{B()}),t.preventDefault()}function Z(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(g.value)return;const t=Me(f),i=Object.values(f),d=v.value.name,A=(i.findIndex(x=>x.name===d)+1)%t.length;v.value=f[t[A]],Z()}function q(t){const i=r.urlList.length;m.value=(t+i)%i}function te(){O.value&&!r.infinite||q(m.value-1)}function ne(){R.value&&!r.infinite||q(m.value+1)}function n(t,i={}){if(g.value)return;const{zoomRate:d,rotateDeg:L,enableTransition:A}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(t){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/d).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*d).toFixed(3)));break;case"clockwise":c.value.deg+=L,s("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=L,s("rotate",c.value.deg);break}c.value.enableTransition=A}return de(W,()=>{_e(()=>{const t=I.value[0];t!=null&&t.complete||(g.value=!0)})}),de(m,t=>{Z(),s("switch",t)}),Ee(()=>{var t,i;$(),(i=(t=h.value)==null?void 0:t.focus)==null||i.call(t)}),o({setActiveItem:q}),(t,i)=>(T(),fe(Ze,{to:"body",disabled:!t.teleported},[y(Ue,{name:"viewer-fade",appear:""},{default:S(()=>[C("div",{ref_key:"wrapper",ref:h,tabindex:-1,class:b(a(l).e("wrapper")),style:me({zIndex:a(u)})},[C("div",{class:b(a(l).e("mask")),onClick:i[0]||(i[0]=Xe(d=>t.hideOnClickModal&&w(),["self"]))},null,2),N(" CLOSE "),C("span",{class:b([a(l).e("btn"),a(l).e("close")]),onClick:w},[y(a(V),null,{default:S(()=>[y(a(Se))]),_:1})],2),N(" ARROW "),a(D)?N("v-if",!0):(T(),M(oe,{key:0},[C("span",{class:b(a(U)),onClick:te},[y(a(V),null,{default:S(()=>[y(a(Ne))]),_:1})],2),C("span",{class:b(a(F)),onClick:ne},[y(a(V),null,{default:S(()=>[y(a(Oe))]),_:1})],2)],64)),N(" ACTIONS "),C("div",{class:b([a(l).e("btn"),a(l).e("actions")])},[C("div",{class:b(a(l).e("actions__inner"))},[y(a(V),{onClick:i[1]||(i[1]=d=>n("zoomOut"))},{default:S(()=>[y(a(Re))]),_:1}),y(a(V),{onClick:i[2]||(i[2]=d=>n("zoomIn"))},{default:S(()=>[y(a($e))]),_:1}),C("i",{class:b(a(l).e("actions__divider"))},null,2),y(a(V),{onClick:ee},{default:S(()=>[(T(),fe(Ye(a(v).icon)))]),_:1}),C("i",{class:b(a(l).e("actions__divider"))},null,2),y(a(V),{onClick:i[3]||(i[3]=d=>n("anticlockwise"))},{default:S(()=>[y(a(Ae))]),_:1}),y(a(V),{onClick:i[4]||(i[4]=d=>n("clockwise"))},{default:S(()=>[y(a(Be))]),_:1})],2)],2),N(" CANVAS "),C("div",{class:b(a(l).e("canvas"))},[(T(!0),M(oe,null,He(t.urlList,(d,L)=>je((T(),M("img",{ref_for:!0,ref:A=>I.value[L]=A,key:d,src:d,style:me(a(P)),class:b(a(l).e("img")),onLoad:G,onError:Q,onMousedown:J},null,46,yt)),[[Ke,L===m.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var kt=ke(bt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const It=Ie(kt),_t=we({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ce([String,Object])},previewSrcList:{type:ce(Array),default:()=>ye([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Et={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>re(e),close:()=>!0,show:()=>!0},Lt=["src","loading"],Ct={key:0},Tt=ie({name:"ElImage",inheritAttrs:!1}),xt=ie({...Tt,props:_t,emits:Et,setup(e,{emit:o}){const s=e;let r="";const{t:f}=he(),k=be("image"),l=qe(),p=Je(),h=z(),I=z(!1),E=z(!0),g=z(!1),m=z(),v=z(),c=j&&"loading"in HTMLImageElement.prototype;let D,O;const R=_(()=>[k.e("inner"),F.value&&k.e("preview"),E.value&&k.is("loading")]),W=_(()=>l.style),U=_(()=>{const{fit:n}=s;return j&&n?{objectFit:n}:{}}),F=_(()=>{const{previewSrcList:n}=s;return Array.isArray(n)&&n.length>0}),P=_(()=>{const{previewSrcList:n,initialIndex:t}=s;let i=t;return t>n.length-1&&(i=0),i}),u=_(()=>s.loading==="eager"?!1:!c&&s.loading==="lazy"||s.lazy),w=()=>{j&&(E.value=!0,I.value=!1,h.value=s.src)};function $(n){E.value=!1,I.value=!1,o("load",n)}function X(n){E.value=!1,I.value=!0,o("error",n)}function G(){tt(m.value,v.value)&&(w(),Z())}const Q=Ve(G,200,!0);async function J(){var n;if(!j)return;await _e();const{scrollContainer:t}=s;De(t)?v.value=t:Fe(t)&&t!==""?v.value=(n=document.querySelector(t))!=null?n:void 0:m.value&&(v.value=et(m.value)),v.value&&(D=K(v,"scroll",Q),setTimeout(()=>G(),100))}function Z(){!j||!v.value||!Q||(D==null||D(),v.value=void 0)}function ee(n){if(n.ctrlKey){if(n.deltaY<0)return n.preventDefault(),!1;if(n.deltaY>0)return n.preventDefault(),!1}}function q(){F.value&&(O=K("wheel",ee,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",g.value=!0,o("show"))}function te(){O==null||O(),document.body.style.overflow=r,g.value=!1,o("close")}function ne(n){o("switch",n)}return de(()=>s.src,()=>{u.value?(E.value=!0,I.value=!1,Z(),J()):w()}),Ee(()=>{u.value?J():w()}),(n,t)=>(T(),M("div",{ref_key:"container",ref:m,class:b([a(k).b(),n.$attrs.class]),style:me(a(W))},[I.value?ae(n.$slots,"error",{key:0},()=>[C("div",{class:b(a(k).e("error"))},Qe(a(f)("el.image.error")),3)]):(T(),M(oe,{key:1},[h.value!==void 0?(T(),M("img",Ge({key:0},a(p),{src:h.value,loading:n.loading,style:a(U),class:a(R),onClick:q,onLoad:$,onError:X}),null,16,Lt)):N("v-if",!0),E.value?(T(),M("div",{key:1,class:b(a(k).e("wrapper"))},[ae(n.$slots,"placeholder",{},()=>[C("div",{class:b(a(k).e("placeholder"))},null,2)])],2)):N("v-if",!0)],64)),a(F)?(T(),M(oe,{key:2},[g.value?(T(),fe(a(It),{key:0,"z-index":n.zIndex,"initial-index":a(P),infinite:n.infinite,"zoom-rate":n.zoomRate,"url-list":n.previewSrcList,"hide-on-click-modal":n.hideOnClickModal,teleported:n.previewTeleported,"close-on-press-escape":n.closeOnPressEscape,onClose:te,onSwitch:ne},{default:S(()=>[n.$slots.viewer?(T(),M("div",Ct,[ae(n.$slots,"viewer")])):N("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):N("v-if",!0)],64)):N("v-if",!0)],6))}});var zt=ke(xt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const $t=Ie(zt);const At="/assets/test-cb18c267.jpg";export{$t as E,At as b};
