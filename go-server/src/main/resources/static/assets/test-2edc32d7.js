import{s as j,v as Le,x as se,y as Ce,l as we,m as ce,z as ye,h as re,A as xe,B as Te,C as he,u as be,D as ze,E as V,F as Se,G as Ne,H as Oe,I as Re,J as $e,K as Ae,L as Be,_ as ke,N as K,O as W,P as Me,w as Ie,Q as Ve,R as Fe}from"./base-3172b268.js";import{s as ie,Q as ve,l as z,R as Xe,S as Ye,h as _,j as de,n as _e,U as Ee,o as x,d as fe,b as y,w as S,a as C,x as b,u as a,H as me,A as De,G as N,c as M,F as oe,e as He,V as Pe,y as We,W as je,C as ae,T as Ke,X as Ze,Y as Ge,Z as Ue,i as Qe,E as qe}from"./index-c39ab14b.js";import{u as Je}from"./index-c8fadf17.js";import{g as et}from"./scroll-b9ab1f4e.js";const tt=(e,o)=>{if(!j||!e||!o)return!1;const s=e.getBoundingClientRect();let r;return o instanceof Element?r=o.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<r.bottom&&s.bottom>r.top&&s.right>r.left&&s.left<r.right};var nt=/\s/;function at(e){for(var o=e.length;o--&&nt.test(e.charAt(o)););return o}var st=/^\s+/;function rt(e){return e&&e.slice(0,at(e)+1).replace(st,"")}var pe=0/0,ot=/^[-+]0x[0-9a-f]+$/i,it=/^0b[01]+$/i,lt=/^0o[0-7]+$/i,ut=parseInt;function ge(e){if(typeof e=="number")return e;if(Le(e))return pe;if(se(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=se(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=rt(e);var s=it.test(e);return s||lt.test(e)?ut(e.slice(2),s?2:8):ot.test(e)?pe:+e}var ct=function(){return Ce.Date.now()};const le=ct;var dt="Expected a function",ft=Math.max,mt=Math.min;function vt(e,o,s){var r,f,k,l,p,h,I=0,E=!1,g=!1,m=!0;if(typeof e!="function")throw new TypeError(dt);o=ge(o)||0,se(s)&&(E=!!s.leading,g="maxWait"in s,k=g?ft(ge(s.maxWait)||0,o):k,m="trailing"in s?!!s.trailing:m);function v(u){var w=r,$=f;return r=f=void 0,I=u,l=e.apply($,w),l}function c(u){return I=u,p=setTimeout(R,o),E?v(u):l}function F(u){var w=u-h,$=u-I,H=o-w;return g?mt(H,k-$):H}function O(u){var w=u-h,$=u-I;return h===void 0||w>=o||w<0||g&&$>=k}function R(){var u=le();if(O(u))return D(u);p=setTimeout(R,F(u))}function D(u){return p=void 0,m&&r?v(u):(r=f=void 0,l)}function Z(){p!==void 0&&clearTimeout(p),I=0,r=h=f=p=void 0}function X(){return p===void 0?l:D(le())}function Y(){var u=le(),w=O(u);if(r=arguments,f=this,h=u,w){if(p===void 0)return c(h);if(g)return clearTimeout(p),p=setTimeout(R,o),v(h)}return p===void 0&&(p=setTimeout(R,o)),l}return Y.cancel=Z,Y.flush=X,Y}var pt="Expected a function";function ue(e,o,s){var r=!0,f=!0;if(typeof e!="function")throw new TypeError(pt);return se(s)&&(r="leading"in s?!!s.leading:r,f="trailing"in s?!!s.trailing:f),vt(e,o,{leading:r,maxWait:o,trailing:f})}const gt=we({urlList:{type:ce(Array),default:()=>ye([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),wt={close:()=>!0,switch:e=>re(e),rotate:e=>re(e)},yt=["src"],ht=ie({name:"ElImageViewer"}),bt=ie({...ht,props:gt,emits:wt,setup(e,{expose:o,emit:s}){const r=e,f={CONTAIN:{name:"contain",icon:ve(xe)},ORIGINAL:{name:"original",icon:ve(Te)}},{t:k}=he(),l=be("image-viewer"),{nextZIndex:p}=ze(),h=z(),I=z([]),E=Xe(),g=z(!0),m=z(r.initialIndex),v=Ye(f.CONTAIN),c=z({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),F=_(()=>{const{urlList:t}=r;return t.length<=1}),O=_(()=>m.value===0),R=_(()=>m.value===r.urlList.length-1),D=_(()=>r.urlList[m.value]),Z=_(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!r.infinite&&O.value)]),X=_(()=>[l.e("btn"),l.e("next"),l.is("disabled",!r.infinite&&R.value)]),Y=_(()=>{const{scale:t,deg:i,offsetX:d,offsetY:L,enableTransition:A}=c.value;let T=d/t,B=L/t;switch(i%360){case 90:case-270:[T,B]=[B,-T];break;case 180:case-180:[T,B]=[-T,-B];break;case 270:case-90:[T,B]=[-B,T];break}const P={transform:`scale(${t}) rotate(${i}deg) translate(${T}px, ${B}px)`,transition:A?"transform .3s":""};return v.value.name===f.CONTAIN.name&&(P.maxWidth=P.maxHeight="100%"),P}),u=_(()=>re(r.zIndex)?r.zIndex:p());function w(){H(),s("close")}function $(){const t=ue(d=>{switch(d.code){case W.esc:r.closeOnPressEscape&&w();break;case W.space:ee();break;case W.left:te();break;case W.up:n("zoomIn");break;case W.right:ne();break;case W.down:n("zoomOut");break}}),i=ue(d=>{const L=d.deltaY||d.deltaX;n(L<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});E.run(()=>{K(document,"keydown",t),K(document,"wheel",i)})}function H(){E.stop()}function Q(){g.value=!1}function q(t){g.value=!1,t.target.alt=k("el.image.error")}function J(t){if(g.value||t.button!==0||!h.value)return;c.value.enableTransition=!1;const{offsetX:i,offsetY:d}=c.value,L=t.pageX,A=t.pageY,T=ue(P=>{c.value={...c.value,offsetX:i+P.pageX-L,offsetY:d+P.pageY-A}}),B=K(document,"mousemove",T);K(document,"mouseup",()=>{B()}),t.preventDefault()}function G(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(g.value)return;const t=Me(f),i=Object.values(f),d=v.value.name,A=(i.findIndex(T=>T.name===d)+1)%t.length;v.value=f[t[A]],G()}function U(t){const i=r.urlList.length;m.value=(t+i)%i}function te(){O.value&&!r.infinite||U(m.value-1)}function ne(){R.value&&!r.infinite||U(m.value+1)}function n(t,i={}){if(g.value)return;const{zoomRate:d,rotateDeg:L,enableTransition:A}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...i};switch(t){case"zoomOut":c.value.scale>.2&&(c.value.scale=Number.parseFloat((c.value.scale/d).toFixed(3)));break;case"zoomIn":c.value.scale<7&&(c.value.scale=Number.parseFloat((c.value.scale*d).toFixed(3)));break;case"clockwise":c.value.deg+=L,s("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=L,s("rotate",c.value.deg);break}c.value.enableTransition=A}return de(D,()=>{_e(()=>{const t=I.value[0];t!=null&&t.complete||(g.value=!0)})}),de(m,t=>{G(),s("switch",t)}),Ee(()=>{var t,i;$(),(i=(t=h.value)==null?void 0:t.focus)==null||i.call(t)}),o({setActiveItem:U}),(t,i)=>(x(),fe(Ze,{to:"body",disabled:!t.teleported},[y(Ke,{name:"viewer-fade",appear:""},{default:S(()=>[C("div",{ref_key:"wrapper",ref:h,tabindex:-1,class:b(a(l).e("wrapper")),style:me({zIndex:a(u)})},[C("div",{class:b(a(l).e("mask")),onClick:i[0]||(i[0]=De(d=>t.hideOnClickModal&&w(),["self"]))},null,2),N(" CLOSE "),C("span",{class:b([a(l).e("btn"),a(l).e("close")]),onClick:w},[y(a(V),null,{default:S(()=>[y(a(Se))]),_:1})],2),N(" ARROW "),a(F)?N("v-if",!0):(x(),M(oe,{key:0},[C("span",{class:b(a(Z)),onClick:te},[y(a(V),null,{default:S(()=>[y(a(Ne))]),_:1})],2),C("span",{class:b(a(X)),onClick:ne},[y(a(V),null,{default:S(()=>[y(a(Oe))]),_:1})],2)],64)),N(" ACTIONS "),C("div",{class:b([a(l).e("btn"),a(l).e("actions")])},[C("div",{class:b(a(l).e("actions__inner"))},[y(a(V),{onClick:i[1]||(i[1]=d=>n("zoomOut"))},{default:S(()=>[y(a(Re))]),_:1}),y(a(V),{onClick:i[2]||(i[2]=d=>n("zoomIn"))},{default:S(()=>[y(a($e))]),_:1}),C("i",{class:b(a(l).e("actions__divider"))},null,2),y(a(V),{onClick:ee},{default:S(()=>[(x(),fe(He(a(v).icon)))]),_:1}),C("i",{class:b(a(l).e("actions__divider"))},null,2),y(a(V),{onClick:i[3]||(i[3]=d=>n("anticlockwise"))},{default:S(()=>[y(a(Ae))]),_:1}),y(a(V),{onClick:i[4]||(i[4]=d=>n("clockwise"))},{default:S(()=>[y(a(Be))]),_:1})],2)],2),N(" CANVAS "),C("div",{class:b(a(l).e("canvas"))},[(x(!0),M(oe,null,Pe(t.urlList,(d,L)=>We((x(),M("img",{ref_for:!0,ref:A=>I.value[L]=A,key:d,src:d,style:me(a(Y)),class:b(a(l).e("img")),onLoad:Q,onError:q,onMousedown:J},null,46,yt)),[[je,L===m.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var kt=ke(bt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const It=Ie(kt),_t=we({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:ce([String,Object])},previewSrcList:{type:ce(Array),default:()=>ye([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Et={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>re(e),close:()=>!0,show:()=>!0},Lt=["src","loading"],Ct={key:0},xt=ie({name:"ElImage",inheritAttrs:!1}),Tt=ie({...xt,props:_t,emits:Et,setup(e,{emit:o}){const s=e;let r="";const{t:f}=he(),k=be("image"),l=Ge(),p=Je(),h=z(),I=z(!1),E=z(!0),g=z(!1),m=z(),v=z(),c=j&&"loading"in HTMLImageElement.prototype;let F,O;const R=_(()=>[k.e("inner"),X.value&&k.e("preview"),E.value&&k.is("loading")]),D=_(()=>l.style),Z=_(()=>{const{fit:n}=s;return j&&n?{objectFit:n}:{}}),X=_(()=>{const{previewSrcList:n}=s;return Array.isArray(n)&&n.length>0}),Y=_(()=>{const{previewSrcList:n,initialIndex:t}=s;let i=t;return t>n.length-1&&(i=0),i}),u=_(()=>s.loading==="eager"?!1:!c&&s.loading==="lazy"||s.lazy),w=()=>{j&&(E.value=!0,I.value=!1,h.value=s.src)};function $(n){E.value=!1,I.value=!1,o("load",n)}function H(n){E.value=!1,I.value=!0,o("error",n)}function Q(){tt(m.value,v.value)&&(w(),G())}const q=Ve(Q,200,!0);async function J(){var n;if(!j)return;await _e();const{scrollContainer:t}=s;Fe(t)?v.value=t:Qe(t)&&t!==""?v.value=(n=document.querySelector(t))!=null?n:void 0:m.value&&(v.value=et(m.value)),v.value&&(F=K(v,"scroll",q),setTimeout(()=>Q(),100))}function G(){!j||!v.value||!q||(F==null||F(),v.value=void 0)}function ee(n){if(n.ctrlKey){if(n.deltaY<0)return n.preventDefault(),!1;if(n.deltaY>0)return n.preventDefault(),!1}}function U(){X.value&&(O=K("wheel",ee,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",g.value=!0,o("show"))}function te(){O==null||O(),document.body.style.overflow=r,g.value=!1,o("close")}function ne(n){o("switch",n)}return de(()=>s.src,()=>{u.value?(E.value=!0,I.value=!1,G(),J()):w()}),Ee(()=>{u.value?J():w()}),(n,t)=>(x(),M("div",{ref_key:"container",ref:m,class:b([a(k).b(),n.$attrs.class]),style:me(a(D))},[I.value?ae(n.$slots,"error",{key:0},()=>[C("div",{class:b(a(k).e("error"))},qe(a(f)("el.image.error")),3)]):(x(),M(oe,{key:1},[h.value!==void 0?(x(),M("img",Ue({key:0},a(p),{src:h.value,loading:n.loading,style:a(Z),class:a(R),onClick:U,onLoad:$,onError:H}),null,16,Lt)):N("v-if",!0),E.value?(x(),M("div",{key:1,class:b(a(k).e("wrapper"))},[ae(n.$slots,"placeholder",{},()=>[C("div",{class:b(a(k).e("placeholder"))},null,2)])],2)):N("v-if",!0)],64)),a(X)?(x(),M(oe,{key:2},[g.value?(x(),fe(a(It),{key:0,"z-index":n.zIndex,"initial-index":a(Y),infinite:n.infinite,"zoom-rate":n.zoomRate,"url-list":n.previewSrcList,"hide-on-click-modal":n.hideOnClickModal,teleported:n.previewTeleported,"close-on-press-escape":n.closeOnPressEscape,onClose:te,onSwitch:ne},{default:S(()=>[n.$slots.viewer?(x(),M("div",Ct,[ae(n.$slots,"viewer")])):N("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):N("v-if",!0)],64)):N("v-if",!0)],6))}});var zt=ke(Tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const $t=Ie(zt);const At="/assets/test-cb18c267.jpg";export{$t as E,At as b};
